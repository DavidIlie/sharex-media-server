import { bold, yellow, cyan } from "nanocolors";
import { execSync } from "child_process";

const getCommitOrFail = () => {
    try {
        return execSync("git rev-parse HEAD").toString().trim();
    } catch (e) {
        return null;
    }
};

const consoleWelcome = () => {
    const commit = getCommitOrFail();

    console.log(
        bold(`
        ░░░░░░░░░░░░░░░░░░░░░░░▓▓▓░░░░░░░░░░░░░░░░░░░░░░░░
        ░░░░░░░░░░░░░░░▒▒▒░░░░▒▓▓▓▓▓░░░░░░▒▓▓▓▒░░░░░░░░░░░
        ░░░░░░░░░░░░░░▒▓▓▓▓▒░░░░▒▓▓▓▓▓░░░░▒▓▓▓▓▓▒░░░░░░░░░
        ░░░░░░░░▒▒░░░░░░▓▓▓▓▓▒░░░░▒▓▓▓▓▓░░░░▒▓▓▓▓▓▒░░░░░░░
        ░░░░░░░▓▓▓▓▓░░░░░░▓▓▓▓▓▒░░░░▒▓▓▓▓▓░░░░▒▓▓▓▓▓▒░░░░░
        ░░░░░░░░▒▓▓▓▓▓░░░░░░▓▓▓▓▓░░░░░▒▓▓▓▓▓░░░░▒▓▓▓▓▒░░░░
        ░░░░░░░░░░▒▓▓▓▓▓░░░░░░▒▒▒░░░░░░░▒▓▓▓▓▓░░░░▒▓▓▓▓░░░
        ░░░▒▓▓▒░░░░░▒▓▓▓▓▓░░░░░░░░░░░░░░░░▒▓▓▓▓▒░░░▒▓▓▓▓░░
        ░░░▒▓▓▓▓▒░░░░░▒▓▓▓▓▓░░░░░░░▒▓▓▓▒░░░░▓▓▓▓▒░░░▒▓▓▓▒░
        ░░░░░▓▓▓▓▓▒░░░░░▒▓▓▓▓▓░░░░░░▒▓▓▓▓░░░░▓▓▓▓░░░░▓▓▓▓░
        ░░░░░░░▓▓▓▓▓▒░░░░░▒▓▓▓▓▓░░░░░▒▓▓▓▓░░░▒▓▓▓▒░░░▒▓▓▓▒
        ▒▒▒▒░░░░░▓▓▓▓▓▒░░░░░▒▓▓▓▓▒░░░░▒▓▓▓▒░░░▓▓▓▓░░░░▓▓▓▓
        ▒▓▓▓▓▒░░░░░▓▓▓▓▓▒░░░░░▒▓▓░░░░░▒▓▓▓▒░░░▓▓▓▓░░░░▓▓▓▓
        ░░▓▓▓▓▓▒░░░░░▓▓▓▓▓▒░░░░░░░░░░▒▓▓▓▓░░░░▓▓▓▓░░░░▓▓▓▓
        ░░░░▓▓▓▓▓▒░░░░░▓▓▓▓▓▒░░░░░░▒▒▓▓▓▓▒░░░▓▓▓▓▒░░░░▒▒▒░
        ░░░░░░▓▓▓▓▓▒░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒░░░░▒▓▓▓▓░░░░░░░░░
        ░░░░░░░░▓▓▓▓▓▒░░░░░▒▒▓▓▓▓▓▓▓▒▒░░░░░▓▓▓▓▓░░░░░░░░░░
        ░░▒▓▓▒░░░░▓▓▓▓▓▒░░░░░░░░░░░░░░░░▒▒▓▓▓▓▒░░░░▓▓▓▒░░░
        ░░▓▓▓▓▓▒░░░░▒▓▓▓▓▓▒▒░░░░░░░░▒▒▒▓▓▓▓▓▒░░░░▒▓▓▓▓▒░░░
        ░░░▒▓▓▓▓▓▒░░░░▒▓▓▓▓▓▓▓░░░░░▓▓▓▓▓▓▓▒░░░░░▒▓▓▓▓░░░░░
        ░░░░░▒▓▓▓▓▓▒░░░░░░▒▒▒░░░░░░▒▒▒▒░░░░░░░▒▓▓▓▓▒░░░░░░
        ░░░░░░░▒▓▓▓▓▓▒▒░░░░░░░░░░░░░░░░░░░░▒▓▓▓▓▓▒░░░░░░░░
        ░░░░░░░░░░▒▓▓▓▓▓▓▒▒▒░░░░░░░░░░▒▒▒▓▓▓▓▓▓▒░░░░░░░░░░
        ░░░░░░░░░░░░░▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒░░░░░░░░░░░░░
      sharex-upload-server (backend) | ${yellow(
          `Pre-relase (${
              commit !== null
                  ? commit.slice(0, 7)
                  : "Unknown (Git cannot be found)"
          })`
      )}
Current commit: ${
            commit !== null
                ? `${cyan(commit)} (${yellow(commit.slice(0, 7))})`
                : "Unknown (Git cannot be found)"
        }
`)
    );
};

export default consoleWelcome;
